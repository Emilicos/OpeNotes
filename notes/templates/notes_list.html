{% extends 'base.html'   %} 

{% block styles %}
<style>
   .remove-default-btn {
	background-color: transparent;
	border: none;
	box-shadow: none;
}

.edit-color {
	color: #333;
}

.post-link {
	text-decoration: none;
}

.post-text {
	padding-top: 0.5rem;
}

.post-img {
	float: left;
	margin-right: 1rem;
}

.post-image {
	max-width: 100%;
	height: auto;
	border-radius: 10px;
	margin-bottom: 10px;
    padding-top: 20px;
}

.child-comment {
	margin-left: 2rem;
}

.notification-badge {
	transition: 0.3s;
}

.notification-badge:hover {
	cursor: pointer;
	opacity: 0.75;
	transition: 0.3s;
}

.dropdown {
	position: relative;
	display: inline-block;
}

.dropdown-content {
	position: absolute;
	background-color: #f1f1f1;
	min-width: 350px;
	box-shadow: 0px 8px 8px 0px rgba(0,0,0,0.2)
	/* z-index: 1;
	font-size: 0.9rem; */
}

.dropdown-content a {
	color: #000;
	padding: 12px 16px;
	text-decoration: none;
	display: block;
}

.dropdown-content a:hover {
	background-color: #ddd;
}

.dropdown-item-parent {
	position: relative;
	display: block;
}

.dropdown-item-close {
	position: absolute;
	top: 0;
	right: 0;
	font-size: 1.8rem;
	padding-right: 5px;
	transition: 0.3s
}

.dropdown-item-close:hover {
	color: rgb(180, 25, 25);
	transition: 0.3s;
	cursor: pointer;
}
.form input[type="text"], .form input[type="number"], .form textarea, .form select {
        background-color: #334155;
        border: solid 1px rgb(203 213 225);
        color: #fff; /* White text color */
        padding: 0.75em 1em;
        border-radius: 0.5em;
    }

    .form p {
        display: flex;
        flex-direction: column;
        row-gap: 1em;
        font-weight: bold;
    }
</style>

{% endblock styles %}

{% block content %}
<div aria-live="polite" id = "toast-placement" aria-atomic="true" style="position: relative" class="font-bold z-[50]"></div>
<div class="container">
<div class="w-full text-right flex justify-end">
    <button type="button" class="bg-green-500 flex shadow text-white rounded-md text-sm border-y border-transparent py-2 font-bold px-3 hover:bg-green-600 dark:hover:bg-green-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-300 dark:focus:ring-offset-slate-900 dark:focus:ring-green-700" data-bs-toggle="modal" data-bs-target="#createModal">Create Notes</button>
</div>

<form method="post" onsubmit="return false;" class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="createModalTitle" aria-hidden="true">
    {% csrf_token %}
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content bg-[#272B52]">
        <div class="modal-header border-b-0">
          <h5 class="font-bold" id="exampleModalLongTitle">Create Notes</h5>
          <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body flex flex-col form gap-y-6">
            <p>
                <label for="id_name">Isi:</label>
                <textarea name="isi" required></textarea>
            </p>
            <input type="file" id="file" name="file" accept=".jpg, .jpeg, .png">
        </div>
        <div class="modal-footer border-t-0">
          <button type="button" data-bs-dismiss="modal" class="bg-rose-500 flex-auto shadow text-white rounded-md text-sm border-y border-transparent py-2 font-bold px-3 hover:bg-rose-600 dark:hover:bg-rose-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-300 dark:focus:ring-offset-slate-900 dark:focus:ring-rose-700" data-dismiss="modal">Batal</button>
          <button type="submit" data-bs-dismiss="modal" id = "button_create" class="bg-green-500 flex-auto shadow text-white rounded-md text-sm border-y border-transparent py-2 font-bold px-3 hover:bg-green-600 dark:hover:bg-green-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-300 dark:focus:ring-offset-slate-900 dark:focus:ring-green-700">Simpan</button>
        </div>
      </div>
    </div>
  </div>
</form>


    {% for notes in notes_list %}
    <div class="row justify-content-center mt-3">
        <figure class="col-xl-6 col-sm-12 relative flex flex-col bg-slate-50 rounded-lg p-6 dark:bg-slate-800 dark:highlight-white/5 font-bold">
            <a href="/notes/{{notes.pk}}/" class="relative">
                <figcaption class="flex items-center space-x-4">
                    <div class="flex-auto">
                        <div class="text-base text-slate-900 font-semibold dark:text-slate-300">
                            <span class="inline-block bg-green-200 rounded px-2 py-1 text-sm font-bold text-slate-700 mr-2 mb-2">{{notes.user}} </span> 
                            
                        </div>
                        
                        <div class="mt-0.5">{{notes.created_on}}</div>
                    </div>
                </figcaption>
                <blockquote class="mt-3 text-slate-700 dark:text-slate-300">
                    <span class="absolute inset-0 pointer-events-none"></span> {{notes.body}}
                    <!-- <p>${course.description}</p> -->
                    {% if notes.photo %}
                    <img src="{{ notes.photo.url }}" class="post-image mx-auto" />
                    {% endif %}
                    <!-- ${getPrerequisites(course)} -->
                </blockquote>
            </a>
            <!-- ${admin ? `<i class="fa-solid fa-gear absolute right-5 cursor-pointer hover:text-slate-300" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></i><div class="dropdown-menu" aria-labelledby="dropdownMenuButton"><button class="dropdown-item cursor-pointer" onclick="" data-bs-toggle="modal" data-bs-target="#updateModal-${course.id}">Update</button><button class="dropdown-item cursor-pointer" onclick="" data-bs-toggle="modal" data-bs-target="#deleteModal-${course.id}">Delete</button></div>` : ''} -->
        </figure>
    </div>
        <br>
        {% endfor %}
        
    </div>
<script>
    function createNotes() {
        console.log(new FormData(document.querySelector('#createModal')))
        fetch(`/notes/`, {
            method: "POST",
            body: new FormData(document.querySelector('#createModal'))
        }).then(res => {
          if(res.ok == true){
            callToast("Success", "Berhasil membuat Notes")
            var link = document.createElement("a");
            link.href = `/notes/`;
            console.log(link.href)
            link.click();
          }
          else
            callToast("Error", "Sistem gagal menyimpan Notes")
        }).catch((error) => {
            console.log(error)
            callToast("Error", "Sistem gagal menyimpan Notes")
        })

        document.getElementById("createModal").reset()
        return false
    }

    document.getElementById("button_create").onclick = createNotes

    function generateToast(status, message) {
        const toast = 
        `
            <div class="toast bg-[#272B52] mx-8 z-50" style="position: fixed; top: 60px; right: 0;">
                <div class="toast-header bg-[#272B52] ${status === "Success" ? 'text-green-500' : 'text-rose-500'}">
                    <strong class="mr-auto ${status === "Success" ? 'text-green-500' : 'text-rose-500'} font-bold text-xl">${status}</strong>
                    <button type="button" class="ml-2 mb-1 close" data-bs-dismiss="toast" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="toast-body">
                    ${message}
                </div>
            </div>
        `
        return toast 
    }

    function callToast(status, message) {
        $('.toast').toast('hide')
        document.getElementById("toast-placement").innerHTML = ""
        const toast = generateToast(status, message)
        document.getElementById("toast-placement").innerHTML = toast
        $('.toast').toast('show')
    }
</script>
    {% endblock content %}